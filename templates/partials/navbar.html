{% load static %}

<head>
    <!-- Link to the global navbar.css file -->
    <link rel="stylesheet" href="{% static 'css/navbar.css' %}">
    <!-- Add a script to fetch user info from the API -->
    <script>
        function updateUserInfo() {
            fetch('/api/userinfo/')
                .then(response => response.json())
                .then(data => {
                    const usernameEl = document.getElementById('username');
                    const pfpEl = document.getElementById('pfp');
                    const coinsEl = document.getElementById('coins');
                    
                    if (usernameEl) usernameEl.innerText = data.username;
                    if (pfpEl) pfpEl.src = data.pfp_url;
                    if (coinsEl) coinsEl.innerText = data.coins;
                })
                .catch(error => {
                    console.error('Error fetching user data:', error);
                });
        }

        // Wait for DOM to be ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', updateUserInfo);
        } else {
            updateUserInfo();
        }
    </script>
</head>

<header class="header">
    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-left">
                <a href="/ecoworld/dashboard" class="navbar-brand">
                    <span>Eco World</span>
                </a>
                <button class="navbar-menu-button" onclick="toggleMenu()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 12h18M3 6h18M3 18h18"/>
                    </svg>
                </button>
            </div>

            <div class="navbar-links" id="navLinks">
                <a href="/ecoworld/dashboard" class="navbar-link">Home</a>
                <a href="/ecoworld/challenge" class="navbar-link">Challenges</a>
                <a href="/guides" class="navbar-link">Guides</a>
                <a href="/ecoworld/store" class="navbar-link">Store</a>
                <a href="/leaderboards" class="navbar-link">Leaderboard</a>
                <a href="/game/play" class="navbar-link">Minigame</a>
                <a href="/forum" class="navbar-link">Forum</a>
                {% if perms.Accounts.can_view_gamekeeper_button %}
                <a href="/ecoworld/gamekeeper" class="navbar-link">Gamekeeper</a>
                {% endif %}
            </div>

            <div class="navbar-user">
                <span id="username" class="navbar-username"></span>
                <a href="/accounts/profile">
                    <img id="pfp" src="{% static 'misc/default_pfp.png' %}" alt="Profile" class="profile-pic">
                </a>
                <span class="navbar-coins">
                    <span id="coins">0</span>
                </span>
                <a href="/ecoworld/friends">
                    <img src="{% static 'misc/friend.png' %}" alt="Friends" class="friend-icon">
                </a>
            </div>
        </div>
    </nav>
</header>

<script>
function toggleMenu() {
    const navLinks = document.getElementById('navLinks');
    navLinks.classList.toggle('active');
}
</script>
